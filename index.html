<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>APEX · MERIDIAN</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{--bg:#0F172A;--bg2:#1E293B;--surface:rgba(30,41,59,0.7);--border:rgba(148,163,184,0.1);--text:#F1F5F9;--text2:#94A3B8;--text3:#64748B;--blue:#3B82F6;--blue2:#60A5FA;--green:#22C55E;--green-bg:rgba(34,197,94,0.15);--red:#EF4444;--red-bg:rgba(239,68,68,0.15);--purple:#A855F7}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;-webkit-font-smoothing:antialiased}
.container{max-width:960px;margin:0 auto;padding:0 16px}
.header{padding:20px 0 12px;position:sticky;top:0;z-index:100;background:rgba(15,23,42,0.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
.header-inner{display:flex;justify-content:space-between;align-items:center}
.header-left h1{font-size:20px;font-weight:800;letter-spacing:.5px;background:linear-gradient(135deg,var(--blue),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.header-left p{font-size:11px;color:var(--text3);margin-top:2px;letter-spacing:.3px}
.header-clock{font-size:14px;font-weight:600;color:var(--text2);font-variant-numeric:tabular-nums}
.header-updated{font-size:10px;color:var(--text3);margin-top:2px;text-align:right}
.ticker-bar{overflow-x:auto;white-space:nowrap;padding:12px 0;border-bottom:1px solid var(--border);scrollbar-width:none}
.ticker-bar::-webkit-scrollbar{display:none}
.ticker-item{display:inline-flex;align-items:center;gap:8px;padding:6px 14px;margin-right:8px;background:var(--surface);border-radius:10px;border:1px solid var(--border)}
.ticker-symbol{font-size:11px;font-weight:700;color:var(--text2)}
.ticker-price{font-size:13px;font-weight:600;font-variant-numeric:tabular-nums}
.ticker-change{font-size:11px;font-weight:600;font-variant-numeric:tabular-nums}
.ticker-change.up{color:var(--green)}.ticker-change.down{color:var(--red)}
.card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:20px;backdrop-filter:blur(10px);transition:transform .2s,box-shadow .2s}
.card:hover{transform:translateY(-1px);box-shadow:0 8px 32px rgba(0,0,0,.2)}
.section-title{font-size:13px;font-weight:700;color:var(--text3);text-transform:uppercase;letter-spacing:1px;margin:24px 0 12px}
.portfolio-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media(max-width:600px){.portfolio-grid{grid-template-columns:1fr}}
.portfolio-card{position:relative;overflow:hidden}
.portfolio-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;border-radius:16px 16px 0 0}
.portfolio-card.apex::before{background:linear-gradient(90deg,var(--blue),var(--purple))}
.portfolio-card.meridian::before{background:linear-gradient(90deg,var(--green),var(--blue))}
.portfolio-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.portfolio-name{font-size:14px;font-weight:700;letter-spacing:.5px}
.bot-status{display:flex;align-items:center;gap:6px;font-size:11px;color:var(--text3)}
.status-dot{width:8px;height:8px;border-radius:50%;background:var(--green);box-shadow:0 0 8px var(--green)}
.status-dot.active{animation:pulse 2s infinite}
.status-dot.inactive{background:var(--text3);box-shadow:none}
@keyframes pulse{0%,100%{opacity:1;box-shadow:0 0 8px var(--green)}50%{opacity:.5;box-shadow:0 0 16px var(--green)}}
.portfolio-balance{font-size:28px;font-weight:800;margin-bottom:16px;font-variant-numeric:tabular-nums}
.portfolio-stats{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.stat-item label{font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;display:block}
.stat-item span{font-size:14px;font-weight:600;font-variant-numeric:tabular-nums}
.perf-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
@media(max-width:600px){.perf-grid{grid-template-columns:repeat(2,1fr)}}
.perf-card{text-align:center;padding:16px 12px}
.perf-card .value{font-size:22px;font-weight:800;font-variant-numeric:tabular-nums}
.perf-card .label{font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:4px}
.position-card{display:flex;align-items:center;gap:12px;padding:14px 16px;margin-bottom:8px;background:var(--surface);border:1px solid var(--border);border-radius:12px;transition:all .2s}
.position-card:hover{border-color:rgba(148,163,184,.2)}
.position-bot{font-size:9px;font-weight:700;padding:3px 8px;border-radius:6px;letter-spacing:.5px;white-space:nowrap;flex-shrink:0}
.position-bot.apex{background:rgba(59,130,246,.15);color:var(--blue2)}
.position-bot.meridian{background:rgba(34,197,94,.15);color:var(--green)}
.position-info{flex:1;min-width:0}
.position-market{font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.position-meta{font-size:11px;color:var(--text3);margin-top:2px;display:flex;gap:8px;flex-wrap:wrap}
.side-pill{font-size:10px;font-weight:700;padding:2px 8px;border-radius:6px;letter-spacing:.3px;flex-shrink:0}
.side-pill.yes{background:var(--green-bg);color:var(--green)}
.side-pill.no{background:var(--red-bg);color:var(--red)}
.position-size{text-align:right;flex-shrink:0}
.position-size .amount{font-size:13px;font-weight:600;font-variant-numeric:tabular-nums}
.trade-item{display:flex;gap:12px;align-items:flex-start;padding:12px 0;border-bottom:1px solid var(--border)}
.trade-item:last-child{border-bottom:none}
.trade-time{font-size:10px;color:var(--text3);min-width:48px;padding-top:2px;font-variant-numeric:tabular-nums}
.trade-content{flex:1;min-width:0}
.trade-header{display:flex;gap:6px;align-items:center;flex-wrap:wrap}
.trade-action{font-size:10px;font-weight:700;padding:2px 6px;border-radius:4px;letter-spacing:.3px}
.trade-action.buy{background:var(--green-bg);color:var(--green)}
.trade-action.sell{background:var(--red-bg);color:var(--red)}
.trade-market{font-size:12px;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.trade-details{font-size:11px;color:var(--text3);margin-top:3px}
.trade-status{font-size:10px;font-weight:600;padding:2px 6px;border-radius:4px;margin-left:auto;flex-shrink:0}
.trade-status.submitted{background:rgba(59,130,246,.15);color:var(--blue2)}
.trade-status.error{background:var(--red-bg);color:var(--red)}
.trade-status.placed{background:rgba(34,197,94,.15);color:var(--green)}
.trade-status.dry_run{background:rgba(148,163,184,.15);color:var(--text3)}
.empty-state{text-align:center;padding:32px;color:var(--text3);font-size:13px}
.footer{padding:32px 0;text-align:center}
.footer p{font-size:11px;color:var(--text3)}
.loading{opacity:0;animation:fadeIn .4s ease forwards}
@keyframes fadeIn{to{opacity:1}}
</style>
</head>
<body>
<div class="header"><div class="container header-inner">
  <div class="header-left"><h1>APEX · MERIDIAN</h1><p>Prediction Market Trading</p></div>
  <div class="header-right"><div class="header-clock" id="clock"></div><div class="header-updated" id="lastUpdated">Loading...</div></div>
</div></div>
<div class="container">
  <div class="ticker-bar" id="tickerBar">
    <div class="ticker-item"><span class="ticker-symbol">BTC</span><span class="ticker-price" id="p-BTC">—</span><span class="ticker-change" id="c-BTC"></span></div>
    <div class="ticker-item"><span class="ticker-symbol">ETH</span><span class="ticker-price" id="p-ETH">—</span><span class="ticker-change" id="c-ETH"></span></div>
    <div class="ticker-item"><span class="ticker-symbol">SOL</span><span class="ticker-price" id="p-SOL">—</span><span class="ticker-change" id="c-SOL"></span></div>
    <div class="ticker-item"><span class="ticker-symbol">XRP</span><span class="ticker-price" id="p-XRP">—</span><span class="ticker-change" id="c-XRP"></span></div>
    <div class="ticker-item"><span class="ticker-symbol">DOGE</span><span class="ticker-price" id="p-DOGE">—</span><span class="ticker-change" id="c-DOGE"></span></div>
  </div>
  <div class="section-title">Portfolio</div>
  <div class="portfolio-grid" id="portfolioGrid"></div>
  <div class="section-title">Performance</div>
  <div class="perf-grid" id="perfGrid"></div>
  <div class="section-title">Open Positions</div>
  <div id="positions"></div>
  <div class="section-title">Recent Trades</div>
  <div class="card" id="trades" style="padding:8px 16px"></div>
  <div class="footer"><p>Auto-refreshes every 60s</p></div>
</div>
<script>
const TM={KXBTC:'Bitcoin',KXBTCD:'Bitcoin',KXETH:'Ethereum',KXETHD:'Ethereum',KXSOL:'Solana',KXSOLD:'Solana',KXXRP:'XRP',KXXRPD:'XRP',KXDOGE:'Dogecoin',KXDOGED:'Dogecoin',KXRECSSNBER:'Recession 2026',KXLARGECUT:'Fed Large Rate Cut',KXAISPIKE:'AI Capability Growth',KXCABLEAVE:'Trump Cabinet Leave',KXFEDMEET:'Fed Emergency Meeting',KXINXPOS:"S&P Positive 2026",KXWARSHNOM:'Warren Sherman Nom.'};

function parseTicker(t){
  const m=t.match(/^(KX[A-Z]+)/);if(!m)return t;
  const p=m[1],name=TM[p]||p;
  const r=t.match(/B(\d+\.?\d*)/);
  if(r){const v=parseFloat(r[1]);
    if(p.includes('XRP'))return name+' $'+v.toFixed(2)+'–$'+(v+.01).toFixed(2);
    if(p.includes('BTC')||p.includes('ETH'))return name+' $'+Math.round(v).toLocaleString()+' range';
    return name+' $'+v+' range';}
  const th=t.match(/T(\d+\.?\d*)/);
  if(th){const v=parseFloat(th[1]);
    if(p.includes('BTC'))return name+' above $'+Math.round(v).toLocaleString();
    if(p.includes('ETH'))return name+' above $'+Math.round(v).toLocaleString();
    if(p.includes('XRP'))return name+' above $'+v.toFixed(2);
    if(p.includes('SOL'))return name+' above $'+Math.round(v);
    return name+' above '+v;}
  return name;
}

const $=id=>document.getElementById(id);
const fmt=(n,d=2)=>n==null?'—':'$'+Number(n).toLocaleString(undefined,{minimumFractionDigits:d,maximumFractionDigits:d});
const pct=n=>n==null?'—':(n*100).toFixed(1)+'%';

function updateClock(){$('clock').textContent=new Date().toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false,timeZone:'UTC'})+' UTC'}
setInterval(updateClock,1000);updateClock();

const SYMS=['BTCUSDT','ETHUSDT','SOLUSDT','XRPUSDT','DOGEUSDT'];
const SH={BTCUSDT:'BTC',ETHUSDT:'ETH',SOLUSDT:'SOL',XRPUSDT:'XRP',DOGEUSDT:'DOGE'};
async function fetchCrypto(){try{
  const r=await fetch('https://api.binance.com/api/v3/ticker/24hr?symbols='+JSON.stringify(SYMS));
  (await r.json()).forEach(t=>{const s=SH[t.symbol],p=parseFloat(t.lastPrice),c=parseFloat(t.priceChangePercent);
    $('p-'+s).textContent=p>=100?'$'+Math.round(p).toLocaleString():'$'+p.toFixed(p>=1?2:4);
    const e=$('c-'+s);e.textContent=(c>=0?'+':'')+c.toFixed(1)+'%';e.className='ticker-change '+(c>=0?'up':'down');});
}catch(e){}}
fetchCrypto();setInterval(fetchCrypto,15000);

function isActive(ts){if(!ts)return false;return(Date.now()-(ts>1e12?ts:ts*1000))<3600000}

async function loadData(){try{const r=await fetch('/data.json?'+Date.now());renderData(await r.json())}catch(e){}}

function renderData(data){
  const o=data.overview||{},apex=o.apex||{},mer=o.meridian||{},pos=data.positions||{},trades=(data.trades||{}).trades||[];
  const ts=o.timestamp||new Date().toISOString();
  $('lastUpdated').textContent='Updated '+new Date(ts).toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit',timeZone:'UTC'})+' UTC';

  const merBal=(mer.balance||0)/100;
  const merPos=(pos.meridian||[]).filter(p=>p.position>0);
  const allMer=mer.positions||pos.meridian||[];
  const merExp=merPos.reduce((s,p)=>s+(p.market_exposure||0),0)/100;
  const merPnl=allMer.reduce((s,p)=>s+(p.realized_pnl||0),0)/100;
  const merFees=allMer.reduce((s,p)=>s+(p.fees_paid||0),0)/100;
  const ap=apex.pnl||{};

  $('portfolioGrid').innerHTML=`
    <div class="card portfolio-card apex loading" style="animation-delay:.05s">
      <div class="portfolio-header"><span class="portfolio-name">APEX</span>
        <div class="bot-status"><div class="status-dot ${isActive(apex.last_scan)?'active':'inactive'}"></div>${isActive(apex.last_scan)?'Active':'Offline'}</div></div>
      <div class="portfolio-balance">${fmt(apex.total_invested||0)}</div>
      <div class="portfolio-stats">
        <div class="stat-item"><label>Invested</label><span>${fmt(apex.total_invested||0)}</span></div>
        <div class="stat-item"><label>Returned</label><span>${fmt(apex.total_returned||0)}</span></div>
        <div class="stat-item"><label>P&amp;L</label><span style="color:${(ap.realized_pnl||0)>=0?'var(--green)':'var(--red)'}">${fmt(ap.realized_pnl||0)}</span></div>
        <div class="stat-item"><label>Open</label><span>${apex.open_positions||0}</span></div>
        <div class="stat-item"><label>Win Rate</label><span>${pct(ap.win_rate||0)}</span></div>
        <div class="stat-item"><label>W / L</label><span>${ap.wins||0} / ${ap.losses||0}</span></div>
      </div></div>
    <div class="card portfolio-card meridian loading" style="animation-delay:.1s">
      <div class="portfolio-header"><span class="portfolio-name">MERIDIAN</span>
        <div class="bot-status"><div class="status-dot ${isActive(mer.last_scan)?'active':'inactive'}"></div>${isActive(mer.last_scan)?'Active':'Offline'}</div></div>
      <div class="portfolio-balance">${fmt(merBal)}</div>
      <div class="portfolio-stats">
        <div class="stat-item"><label>Exposure</label><span>${fmt(merExp)}</span></div>
        <div class="stat-item"><label>P&amp;L</label><span style="color:${merPnl>=0?'var(--green)':'var(--red)'}">${fmt(merPnl)}</span></div>
        <div class="stat-item"><label>Fees</label><span>${fmt(merFees)}</span></div>
        <div class="stat-item"><label>Open</label><span>${merPos.length}</span></div>
      </div></div>`;

  const totalDep=(apex.total_invested||0)+merExp;
  const totalPnl=(ap.realized_pnl||0)+merPnl;
  $('perfGrid').innerHTML=`
    <div class="card perf-card loading" style="animation-delay:.15s"><div class="value">${fmt(totalDep)}</div><div class="label">Total Deployed</div></div>
    <div class="card perf-card loading" style="animation-delay:.2s"><div class="value" style="color:${totalPnl>=0?'var(--green)':'var(--red)'}">${fmt(totalPnl)}</div><div class="label">Total P&amp;L</div></div>
    <div class="card perf-card loading" style="animation-delay:.25s"><div class="value">${pct(ap.win_rate||0)}</div><div class="label">Win Rate</div></div>
    <div class="card perf-card loading" style="animation-delay:.3s"><div class="value">${(apex.open_positions||0)+merPos.length}</div><div class="label">Positions</div></div>`;

  // Positions
  const allPos=[];
  (pos.apex||[]).filter(p=>p.status==='open').forEach(p=>allPos.push({bot:'apex',market:p.market_question||'Unknown',side:p.side,size:fmt(p.size_usdc),entry:p.entry_price?(p.entry_price*100).toFixed(1)+'¢':'—',contracts:p.num_tokens?Math.round(p.num_tokens):'—',pnl:null}));
  merPos.forEach(p=>allPos.push({bot:'meridian',market:parseTicker(p.ticker),side:'YES',size:fmt((p.market_exposure||0)/100),entry:'—',contracts:p.position,pnl:p.realized_pnl&&p.realized_pnl!==0?fmt(p.realized_pnl/100):null}));

  $('positions').innerHTML=allPos.length===0?'<div class="card empty-state">No open positions</div>':
    allPos.map((p,i)=>`<div class="position-card loading" style="animation-delay:${.35+i*.03}s">
      <span class="position-bot ${p.bot}">${p.bot.toUpperCase()}</span>
      <div class="position-info"><div class="position-market">${p.market}</div>
        <div class="position-meta"><span>${p.contracts} contracts</span><span>Entry ${p.entry}</span>${p.pnl?`<span style="color:${p.pnl.includes('-')?'var(--red)':'var(--green)'}">P&L ${p.pnl}</span>`:''}</div></div>
      <span class="side-pill ${p.side.toLowerCase()}">${p.side}</span>
      <div class="position-size"><div class="amount">${p.size}</div></div></div>`).join('');

  // Trades
  const rt=trades.slice(0,20);
  $('trades').innerHTML=rt.length===0?'<div class="empty-state">No recent trades</div>':
    rt.map(t=>{
      const time=t.timestamp?new Date(t.timestamp):null;
      const ts=time?time.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit',timeZone:'UTC'}):'—';
      const bot=(t._bot||'').toLowerCase();
      const act=(t.action||'').toUpperCase();
      const isBuy=act.includes('BUY')||act.includes('PLACE');
      const st=t.status||'unknown';
      const mkt=t.market||parseTicker(t.ticker||'');
      const sz=t.size_usdc?fmt(t.size_usdc):t.cost_cents?fmt(t.cost_cents/100):'—';
      const pr=t.price!=null&&t.price<10?(t.price<1?(t.price*100).toFixed(0)+'¢':t.price):t.price_cents?t.price_cents+'¢':'';
      return `<div class="trade-item">
        <div class="trade-time">${ts}</div>
        <div class="trade-content">
          <div class="trade-header">
            <span class="position-bot ${bot}">${bot.toUpperCase()}</span>
            <span class="trade-action ${isBuy?'buy':'sell'}">${act.replace('LIMIT_','').replace('PLACE_ORDER','BUY')}</span>
            <span class="trade-status ${st}">${st==='dry_run'?'DRY':st.toUpperCase()}</span>
          </div>
          <div class="trade-market">${mkt}</div>
          <div class="trade-details">${sz}${pr?' @ '+pr:''}${t.side?' · '+t.side.toUpperCase():''}</div>
        </div></div>`}).join('');
}

loadData();setInterval(loadData,60000);
</script>
</body>
</html>